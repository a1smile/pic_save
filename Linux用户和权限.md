# root用户

root（超级管理员）

拥有最大的系统权限

- 普通用户的权限，一般在其HOME目录内是不受限的
- 一旦出了HOME目录，大多数地方，普通用户仅有只读和执行权限，无修改权限

## su和exit命令

su命令就是用于账户切换的系统命令，其来源英文单词：Switch User

语法：

```
su [-][用户名]
```

- 选项，-，符号是可选的，表示是否在切换用户后加载环境变量，**建议带上**
- 参数：用户名。表示要切换的用户，用户名也可以省略，省略表示切换到root
- **切换用户后，可以通过exit命令退回上一个用户，也可以使用快捷键：ctrl + d**
- 使用普通用户，切换到其他用户**需要i输入密码**，如切换到root用户
- 使用root用户切换到其他用户，**无需密码**，可以直接切换

## sudo命令

为了避免长期使用root用户带来系统损坏，我们可以使用sudo命令，为普通的命令授权，临时以root身份执行

语法：

```
sudo 其他命令
```

- 在其他命令之前，带上sudo，即可为这一条命令临时赋予root权限
- 但是并不是所有的用户都有权力使用sudo，我们**需要为普通用户配置sudo认证**

## 为普通用户配置sudo认证

- 切换到root用户，执行 **visudo** 命令，会自动通过vi编辑器打开:/etc/sudoers 也可以输入 **vi   /etc/sudoers**

- 在文件的最后添加：

  ```
  用户名 ALL =(ALL)   NOPASSWD: ALL
  ```

  - 其中最后的NOPASSWD:ALL表示使用sudo命令，无需输入密码

- 最后通过wq保存

- 切回到普通用户![image-20241209200205123](D:\学习资料\实验室培训\运维\image\image-20241209200205123.png)

执行的命令均以root运行

# 用户、用户组管理

Linux系统中可以

- 配置多个用户
- 配置多个用户组
- 用户可以加入多个用户组中

![image-20241209200659571](D:\学习资料\实验室培训\运维\image\image-20241209200659571.png)

Linux中关于**权限的管控级别有2个级别**，分别是：

- 针对用户的权限控制（用户级别）
- 针对用户组的权限控制（用户组级别）

比如，针对某文件，可以控制用户的权限，也可以控制用户组的权限。所以，我们需要学习在Linux中进行用户、用户组管理的基础命令。

## 用户组管理

**以下命令需要root用户执行**

- 创建用户组

  ```
  groupadd 用户组名
  ```

- 删除用户组

  ```
  groupdel 用户组名
  ```

## 用户管理

**以下命令需要root用户执行**

- 创建用户

  ```
  useradd[-g -d] 用户名
  ```

  - 选项：-g，指定用户的组，不指定 -g，会创建同名组并自动加入，指定 -g 需要组已经存在，如已经存在同名组，必须使用-g
  - 选项：-d，指定用户HOME路径，不指定，HOME目录默认在：/home/用户名

- 删除用户

  ```
  userdel[-r] 用户名
  ```

  - 选项，-r，删除用户的HOME目录，不使用-r，删除用户时，HOME目录保留

- 查看用户所属组

  ```
  id[用户名]
  ```

  - 参数：用户名，被查看的用户，如果不提供则查看自身

- 修改用户所属组

  ```
  usermod -aG 用户组  用户名
  ```

  - 将指定的用户加入指定的用户组

- 查看当前系统中有哪里用户

  ```
  getent passwd
  ```

  ![image-20241209204002664](D:\学习资料\实验室培训\运维\image\image-20241209204002664.png)



共有7份信息，分别是：

用户名：密码(x)：用户ID：组ID：描述信息(无用)：HOME目录：执行终端(默认bash)

- 查看当前系统中有哪些用户组

  ```
  getent group
  ```

  ![image-20241209204329211](D:\学习资料\实验室培训\运维\image\image-20241209204329211.png)

包含3份信息

组名称：组认证（显示为x）：组ID

# 查看权限管控

## 认知权限信息

通过ls -l 可以以列表形式查看内容，并显示权限细节

![image-20241209205026322](D:\学习资料\实验室培训\运维\image\image-20241209205026322.png)

- 序号1，表示文件、文件夹的权限控制信息
- 序号2，表示文件、文件夹所属用户
- 序号3，表示文件、文件夹所属用户组

对序号1进行细节刨析

![image-20241209205228742](D:\学习资料\实验室培训\运维\image\image-20241209205228742.png)

举例：drwxr-xr-x，表示

- 这是一个文件夹，首字母d表示
- 所属用户的权限是：有r有w有x，rwx
- 所属用户组的权限是：有r无w有x，r-x（- 表示无此权限）
- 其他用户的权限是：有r无w有x，r-x

###    rwx的意义

- r 表示读权限
- w 表示写权限
- x 表示执行权限

针对文件、文件夹的不同，rwx的含义有细微差别

- r，针对文件可以查看文件内容
  - 针对文件夹，可以查看文件夹内，如 ls 命令
- w，针对文件表示可以修改此文件
  - 针对文件夹，可以在文件夹内：创建、删除、改名等操作
- x，针对文件表示可以将文件作为程序执行
  - 针对文件夹，表示可以更改工作目录到此文件夹，即 cd 进入

## 修改权限控制 —chmod

我们可以通过chmod命令，修改文件、文件夹的权限信息。

**注意：只有文件、文件夹的所属用户或root用户可以修改**

语法：

```
chmod [-R] 权限 文件或文件夹
```

- 选项：-R，对文件夹内的全部内容应用同样的操作

示例：

- chmod u=rwx,g=rx,o=x hello.txt    将文件权限修改为：rwxr-x--x
  - 其中：u表示user所属用户权限，g表示group组权限，o表示other其他用户权限
- chmod -R u=rwx,g=rw,o=x  test     将文件夹test以及文件夹内全部内容权限设置为：rwxr-x--x

### 权限的数字序号

权限可以用3位数字来代表，第一位数字表示用户权限，第二位表示用户组权限，第三位表示其他用户权限

数字的细节如下：r记为4，w记为2，x记为1.可以有：

0:无任何权限，即 ---
1:仅有x权限即 --X
2:仅有w权限即 -W-
3:有w和x权限即-WX
4:仅有r权限即r--
5:有r和x权限r-X
6:有r和w权限即 rw-
7:有全部权限即 rwX

## 修改权限控制 —chown

使用chown命令，可以修改文件、文件夹的所属用户和用户组

**普通用户无法修改所属为其他用户或组，所以此命令之适用于root用户执行**

语法：

```
chown [-R][用户][:][用户组] 文件或文件夹
```

- 选项，-R，同chmod，对文件夹内全部内容应用相同规则
- 选项，用户，修改所属用户
- 选项，用户组，修改所属用户组
-    :   用于分隔用户和用户组

示例：

- chown root hello.txt   将hello.txt所属用户修改为root
- chown :root hello.txt   将hello.txt所属用户组修改为root
- chown root :itheima hello.txt   将hello.txt所属用户修改为root，用户组修改为itheima
- chown -R root test    将文件夹test的所属用户修改为root并对文件夹内全部内容应用同样规则